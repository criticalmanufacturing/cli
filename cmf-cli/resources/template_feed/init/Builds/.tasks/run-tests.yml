parameters:
  TestAssembly: ''
  TestRunTitle: ''
steps:
- task: VSTest@2
  displayName: Run Tests - ${{parameters.TestRunTitle}}
  inputs:
    testAssemblyVer2: ${{parameters.TestAssembly}}
    searchFolder: $(Build.ArtifactStagingDirectory)/TestExecution/
    resultsFolder: $(Agent.TempDirectory)/TestResults
    runSettingsFile: $(CandidatePackages)/Configurations/RunSettings/$(RunSettings)
    testRunTitle: ${{parameters.TestRunTitle}} Tests
    rerunFailedTests: true
    rerunType: basedOnTestFailurePercentage
    rerunFailedThreshold: 100
    rerunMaxAttempts: 3
  continueOnError: true