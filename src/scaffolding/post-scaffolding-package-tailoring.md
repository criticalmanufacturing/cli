# Post-scaffolding package tailoring

The packages generated by `cmf new` are as neutral as possible, so to be compatible with as many deployment scenarios as possible. However, some tailoring is advised for specific targets. This tailoring allows the packages to better adapt to their deployment target, eliminating the need of manual steps when installing.

Below are some tailoring options for specific targets. It's recommended that these changes are applied according to your target environment.

## Containers:
 - **Root Package**
   - Add to dependencies
        ```json
        "dependencies": [
            { "id": "Cmf.Environment", "version": "8.3.0" }
        ]
        ```
 - **Business Package**
   - Add to steps:
        ```json
        "steps": [
            { "order": "1", "type": "DeployFiles", "ContentPath": "**/!(Cmf.Custom.*.BusinessObjects*).dll" }
        ]
        ```

## Deployment Framework:
 - **Root and IoT Root Package**
   - Add to dependencies
        ```json
        "dependencies": [
            { "id": "CriticalManufacturing.DeploymentMetadata", "version": "8.3.0" }
        ]
        ```
 - **Business Package**
   - Add to steps:
        ```json
        "steps": [
            { "order": 1, "type": "Generic", "onExecute": "$(Agent.Root)/agent/scripts/stop_host.ps1" },
            { "order": 2, "type": "DeployFiles", "ContentPath": "**/!(Cmf.Custom.*.BusinessObjects*).dll" },
            { "order": 3, "type": "Generic", "onExecute": "$(Agent.Root)/agent/scripts/start_host.ps1" }
        ]
        ```
  - **Data, IoTData and Tests MasterData Package**
    - Add to steps:
        ```json
        "steps": [
            { "order": 1, "type": "Generic", "onExecute": "$(Agent.Root)/agent/scripts/stop_host.ps1" },
            { "order": 2, "type": "TransformFile", "file": "Cmf.Foundation.Services.HostService.dll.config", "tagFile": true },
            { "order": 3, "type": "Generic", "onExecute": "$(Agent.Root)/agent/scripts/start_host.ps1" },
            { "order": 4, "type": "DeployFiles", "ContentPath": "GenerateLBOs.ps1" },
            { "order": 5, "type": "Generic", "onExecute": "$(Package[Cmf.Custom.Package].TargetDirectory)/GenerateLBOs.ps1" }
        ]
        ```

**NOTE:** Make sure that the order of the steps is the same referenced in this document.